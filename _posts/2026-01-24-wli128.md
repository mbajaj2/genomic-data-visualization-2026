---
layout: post
title:  "HW1"
author: Will
jhed: wli128
categories: [ HW1 ]
image: homework/hw1/HW1_wli128.png
featured: false
---

### 1. What data types are you visualizing?
I'm plotting the expression of the gene Cyp4b1 by counts (quantatative). I am also plotting its x,y coordinates (quantitative).

### 2. What data encodings (geometric primitives and visual channels) are you using to visualize these data types?
I'm using points and their hue/saturation represents their quantity.

### 3. What about the data are you trying to make salient through this data visualization? 
I tried to visualize the distribution of Cyp4b1 expression in the mouse kidney, showing that it is mostly expressed in the Renal medulla layer of the kidney.

### 4. What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?
Similarity of cells with the same color.
Continuity of cells can be observed to form some structures of the nephron.

### 5. Code 

```r
library(ggplot2)
data <- read.csv("data/Xenium-IRI-ShamR_matrix.csv.gz")
dim(data) #80k cells, 302 genes

pos <- data[, c('x', 'y')]
rownames(pos) <- data[,1]

gexp <- data[, 4:ncol(data)]
rownames(gexp) <- data[,1]

std <- data.frame(
  std = apply(data[, 4:302], 2, sd, na.rm = FALSE)
)
std <- std[order(std$std, decreasing = TRUE), , drop = FALSE]
most_std_genes <- head(rownames(std), 10)

df <- data.frame(
  pos,
  gene = gexp[, "Cyp4b1"]
)
ggplot(df) + geom_point(aes(x=x, y=y, col= log10(gene+1)), size=0.01)